<!DOCTYPE html>
<html lang="en">
<title>&#127912 Artificial Artifacts</title>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel=“canonical” href=“https://nzart.app/api/generator” />
    <meta name="description" content="Artificial Artifacts - Use the power of Stable-Diffusion to generate mind blowing art from just a text description" >
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="en_NZ" />
    <meta property="og:url" content="https://nzart.app" />
    <meta property="og:title" content="Artificial Artifacts" />
    <meta property="og:description" content="Generate Mind Blowing Art with the help of Artificial Intelligence." />
    <meta property="og:image" content="https://artificialartifacts9b50.blob.core.windows.net/www/nzart-app.jpg" />
    <link rel="apple-touch-icon" sizes="180x180"
        href="https://artificialartifacts9b50.blob.core.windows.net/www/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32"
        href="https://artificialartifacts9b50.blob.core.windows.net/www/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16"
        href="https://artificialartifacts9b50.blob.core.windows.net/www/favicon-16x16.png">
    <link rel="manifest" href="https://nzart.app/api/manifest">
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2QSZV6W319"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-2QSZV6W319');
</script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    /*Helpful in terms of calculating sizes*/
    * {
        box-sizing: border-box;
    }

    /* Create two equal columns that floats next to each other */
    .column {
        float: left;
        padding: 10px;
    }

    .column img {
        margin-top: 12px;
        width: 100%;
    }

    .container:has(img:hover) {
        scale: .8;
        opacity: .7;
        transition: scale 350ms ease, opacity 350ms linear;
    }

    /* Clear floats after the columns */
    .row:after {
        content: "";
        display: table;
        clear: both;
    }

    body {
        margin: 0;
        font-family: Arial;
        overflow: scroll;
        max-width: 1088px;
        min-height: 2160px;
        margin: auto;
        padding: 10px;
        overflow: scroll;
        background: linear-gradient(to top, #4e4376, #2b5876);
        overflow-x: hidden;
        /*
            background image would cover entire page, but blur would only affect content in vertical strip
            background:url("https://source.unsplash.com/random?geometric/1280x720");
            background-size:cover;
            backdrop-filter: blur(20px);*/
    }

    input:hover,
    input:focus {
        box-shadow: 0px 0px 10px 5px #ffffc854;
        transition: all 0.2s ease-in;
    }

    img:hover {
        box-shadow: 0px 0px 10px 5px #ffffc854;
        transition: all 0.2s ease-in;
    }

    button:hover {
        box-shadow: 0px 0px 10px 5px #ffffc854;
        transition: all 0.2s ease-in;
    }

    .container {
        height: auto;
        display: flex;
    }

    .loader {
        box-shadow: none !important;
    }
</style>

<div id="content">
    <div class="userinput" style="padding:1%;align-items: center;">
        <input title="prompt input"
            placeholder="Enter in the your prompt for AI Art Generation - Powered by https://computerender.com/"
            label="Enter what you want to see" id="prompt" style="width:100%;padding:5px;" autocomplete="off" />
        <button type="button" id="btnGenerate" onload="fixUrl()" onclick="generate()"
            style="padding:5px;margin:auto;width:50%;background:#ffffff00;color:white;border-color:white;margin-top:2px;">&#128259;
            Generate</button>
        <button type="button" id="btnShare" onclick="share()"
            style="padding:5px;margin:auto;width:49%;float:right;background:#ffffff00;color:white;border-color:white;margin-top:2px;">&#x1F517;Copy
            link to clipboard</button>

        <!--<button id="btnDownload"
                style="padding:5px;margin:auto;width:25%;margin-left:5%;" onclick="downloadAll()">Download</button>-->
    </div>
    <flexbox id="container" onload="fixUrl();"></flexbox>

    <div id="inspirationHeader"
        style="background: linear-gradient(to top, #4e4376, #2b5876);padding:1%;align-items: center;display:none;">
        <h1 style="color:white;">Inspiration</h1>
        <p style="color:white;">Here are some prompts that others have used - Click the prompt text to copy into the generator prompt box.
            Powered by <a href="https://lexica.art/" style="color:white;">Lexica.art</a></p>
        <flexbox id="inspiration"></flexbox>
    </div>


    <script>
        const params = new Proxy(new URLSearchParams(window.location.search), {
            get: (searchParams, prop) => searchParams.get(prop),
        });

        let imagesLoaded = 0;
        let numberToGenerate = 6;
        if (params.iteration != undefined) {
            numberToGenerate = params.iteration;
        }

        var input = document.getElementById("prompt");
        input.addEventListener("keydown", function (e) {
            if (e.code === "Enter") {
                generate();
            }
        });

        function resetState() {
            var share = document.getElementById("btnShare");
            share.innerHTML = "&#x1F517;Copy link to clipboard";
        }

        function fixUrl() {
            window.history.pushState("https://nzart.app", "Artificial Artifacts", "/");
        }

        // Get the value of "prompt" in eg "https://example.com/?prompt=some_value"
        let seed = params.seed;
        let queryPrompt = params.prompt; // "prompt"      
        if (queryPrompt != undefined) {
            console.log(`prompt:${queryPrompt}-seed:${seed}`);
            var input = document.getElementById("prompt");
            input.value = queryPrompt;
            generate();
        }

        function share() {
            var prompt = document.getElementById("prompt").value;
            var btnShare = document.getElementById("btnShare");
            var url = window.location.href + `?prompt=${encodeURIComponent(prompt)}`;
            // Copy the text inside the text field
            navigator.clipboard.writeText(url);
            btnShare.innerHTML = "&#x2705; - Copied URL to clipboard";
            setTimeout(resetState, 2000);
        }

        function shuffleTitle() {
            //updates the title of the webpage every second
            setInterval(function () {
                var emojis = ["👨‍🎨", "👩‍🎨", "🖼️", "🎨", "🎭"];
                document.title = emojis[Math.floor(Math.random() * emojis.length)] + " Artificial Artifacts";
            }, 1000);
        }

        //function to check every 500ms whether imagesLoaded is equal to numberToGenerate
        function loadCheck() {
            setInterval(function () {
                if (imagesLoaded == numberToGenerate) {
                    imagesLoaded = 0;
                    console.log("All image requests finished");
                    var btnGenerate = document.getElementById("btnGenerate")
                    btnGenerate.innerHTML = "&#128259; Generate";
                    btnGenerate.disabled = false;
                }
            }, 500);
        }

        //javascript fetch for https://lexica.art/api/v1/search?q=apples which loads images based off the image src
        function apiFetch(url, callback) {
            fetch(url)
                .then(response => response.json())
                .then(data => callback(data));
        }

        function inspirationLoader(prompt){            
            var inspirationHeader = document.getElementById("inspirationHeader");
            inspirationHeader.style = "display:block;"       
            apiFetch(`https://lexica.art/api/v1/search?q=${prompt}`, function (data) {
                console.log(data);
                //sort data based by the height attribute
                data.images.sort(function (a, b) {
                    return a.height - b.height;
                }).reverse();

                var container = document.getElementById("inspiration");
                container.innerHTML = "";
                for (var i = 0; i < data.images.length; i++) {
                    var column = document.createElement("div");
                    column.className = "column";
                    column.style = "width:25%;height:auto;margin:10px";

                    var img = document.createElement("img");
                    img.setAttribute("loading", "lazy");
                    img.src = data.images[i].src;
                    img.style = "height:auto;";

                    var header = document.createElement("div");
                    //header on click will copy the text to the clipboard
                    header.onclick = function () {
                        var prompt = document.getElementById("prompt");
                        prompt.value = this.textContent;
                        navigator.clipboard.writeText(this.textContent);
                        this.innerHTML = "&#x2705; - Copied to clipboard";
                    }
                    header.innerHTML = data.images[i].prompt;
                    header.style = "color:white;margin:10px;text-align:center;";
                    column.appendChild(img);
                    column.appendChild(header);
                    container.appendChild(column);
                }
            });
        }

        function generate() {        
            var prompt = document.getElementById("prompt").value;
            if (prompt != undefined && prompt != "") {
                console.log("Generating...");
                inspirationLoader(prompt);            
                shuffleTitle();
                loadCheck();
                for (let i = 1; i <= numberToGenerate; i++) {
                    const col = document.createElement("div");
                    const link = document.createElement("a");
                    var btnGenerate = document.getElementById("btnGenerate");
                    btnGenerate.disabled = true;
                    col.className = "column";
                    const img = new Image();
                    const loader = new Image();
                    loader.src = "https://artificialartifacts9b50.blob.core.windows.net/www/spinner.svg";
                    loader.classList.add('loader');
                    loader.id = "loader";
                    loader.style = "width:238px;margin:128px;"

                    img.onload = function () {
                        document.title = "Artificial Artifacts";
                        loader.style = "display:none;width:0px;";
                        imagesLoaded++;
                    }
                    img.onerror = function () {
                        img.src = "https://artificialartifacts9b50.blob.core.windows.net/www/failure.png";
                        img.style = "width:512px;";
                        document.title = "Arificial Artifacts"
                        imagesLoaded++;
                    };
                    btnGenerate.innerHTML = "&#x1F914; - Generating...";
                    document.title = "Generating...";
                    //provided ?test = true will use a test image
                    if (params.test != undefined) {
                        img.src = "https://api.computerender.com/generate/blue-barn-with-a-red-door.png";
                        link.href = `https://nzart.app/api/downloader?prompt=${prompt}&seed=${i}&generate=false`;
                    } else {
                        img.src = `https://nzart.app/api/downloader?prompt=${prompt}&seed=${i}&generate=true`;
                        link.href = `https://nzart.app/api/downloader?prompt=${prompt}&seed=${i}&generate=false`;
                    }
                    link.appendChild(loader);
                    link.appendChild(img)

                    link.download = `${prompt}-${i}.png`;
                    link.target = "_blank";
                    col.appendChild(link);

                    var container = document.getElementById("container");
                    if (container.children?.length >= numberToGenerate) {
                        container.prepend(col);
                    }
                    else {
                        container.appendChild(col);
                    }
                    prompt.value = undefined;
                }
            }
        }        
    </script>
</html>