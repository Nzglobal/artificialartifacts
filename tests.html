<!DOCTYPE html>
<html lang="en">
<title>&#127912 NZ Art Tests</title>

<script>
  

    function runTests() {
        // passing so commenting out onlyAddUnique();
        sortByDate();
    }

    function sortByDate(){        
        console.log(`First result should be fifth of October`);
        var state = [];
        var data = "Ww0KCXsNCgkJIkluc2VydGlvblRpbWUiOiAiU3VuLCAwMiBPY3QgMjAyMiAwMTozNDo1MCBHTVQiDQoJfSwNCgl7DQoJCSJJbnNlcnRpb25UaW1lIjogIlN1biwgMDMgT2N0IDIwMjIgMDE6MzU6MTIgR01UIg0KCX0sDQoJew0KCQkiSW5zZXJ0aW9uVGltZSI6ICJTdW4sIDAxIE9jdCAyMDIyIDAxOjM0OjM5IEdNVCINCgl9LA0KCXsNCgkJIkluc2VydGlvblRpbWUiOiAiU3VuLCAwNSBPY3QgMjAyMiAwMTozNDozOSBHTVQiDQoJfQ0KXQ";
        var appendMe = "lSR2x6Y0d4aGVVNWhiV1VpT2lKRFlYUWlMQ0pUYjNWeVkyVWlPaUpqYkdsbGJuUWlmUT09Ig0KCX0sDQoJew0KCQkiTWVzc2FnZUlkIjogIjI5MWY3NTI1LWM5NTUtNGIwNC1iZjU0LTk0NzA4ZDFiZWU0ZiIsDQoJCSJJbnNlcnRpb25UaW1lIjogIlN1biwgMDMgT2N0IDIwMjIgMDE6MzU6MTIgR01UIiwNCgkJIkV4cGlyYXRpb25UaW1lIjogIlN1biwgMDkgT2N0IDIwMjIgMDE6MzU6MTIgR01UIiwNCgkJIlBvcFJlY2VpcHQiOiAiQWdBQUFBTUFBQUFBQUFBQUpOc1NQUC9WMkFFPSIsDQoJCSJUaW1lTmV4dFZpc2libGUiOiAiU3VuLCAwMyBPY3QgMjAyMiAwMTozNToyMCBHTVQiLA0KCQkiRGVxdWV1ZUNvdW50IjogIjIiLA0KCQkiTWVzc2FnZVRleHQiOiAiZXlKdlpHRjBZUzV0WlhSaFpHRjBZU0k2SW1oMGRIQnpPaTh2WVhKMGFXWnBZMmxoYkdGeWRHbG1ZV04wY3psaU5UQXVkR0ZpYkdVdVkyOXlaUzUzYVc1a2IzZHpMbTVsZEM4a2JXVjBZV1JoZEdFamRYSnNjeTlBUld4bGJXVnVkQ0lzSW05a1lYUmhMbVYwWVdjaU9pSlhMMXdpWkdGMFpYUnBiV1VuTWpBeU1pMHhNQzB3TWxRd01TVXpRVE0xSlROQk1URXVOamcyT0RNeU0xb25YQ0lpTENKUVlYSjBhWFJwYjI1TFpYa2lPaUl4SWl3aVVtOTNTMlY1SWpvaVlUQTRNVFV6Wm1ZdE5EVmpaUzAwTlRrNUxXSTFZekl0WlRjME9ERm1ZMlJqWVdJNElpd2lWR2x0WlhOMFlXMXdJam9pTWpBeU1pMHhNQzB3TWxRd01Ub3pOVG94TVM0Mk9EWTRNekl6V2lJc0lsQnliMjF3ZEZSbGVIUWlPaUpFYjJkbmJ5SXNJbE5sWldSeklqb2lOVGcxT0RnaUxDSkVhWE53YkdGNVRtRnRaU0k2SWtwbGNtVnRhV0ZvSWl3aVUyOTFjbU5sSWpvaVkyeHBaVzUwSW4wPSINCgl9LA0KCXsNCgkJIk1lc3NhZ2VJZCI6ICI2ZTc1M2FiMC1hOGY2LTRhZTYtYTFiNy1iNzU2YTY4OGQ1MDkiLA0KCQkiSW5zZXJ0aW9uVGltZSI6ICJTdW4sIDAxIE9jdCAyMDIyIDAxOjM0OjM5IEdNVCIsDQoJCSJFeHBpcmF0aW9uVGltZSI6ICJTdW4sIDA5IE9jdCAyMDIyIDAxOjM0OjM5IEdNVCIsDQoJCSJQb3BSZWNlaXB0IjogIkFnQUFBQU1BQUFBQUFBQUFKTnNTUFAvVjJBRT0iLA0KCQkiVGltZU5leHRWaXNpYmxlIjogIlN1biwgMDEgT2N0IDIwMjIgMDE6MzU6MjAgR01UIiwNCgkJIkRlcXVldWVDb3VudCI6ICIyIiwNCgkJIk1lc3NhZ2VUZXh0IjogImV5SnZaR0YwWVM1dFpYUmhaR0YwWVNJNkltaDBkSEJ6T2k4dllYSjBhV1pwWTJsaGJHRnlkR2xtWVdOMGN6bGlOVEF1ZEdGaWJHVXVZMjl5WlM1M2FXNWtiM2R6TG01bGRDOGtiV1YwWVdSaGRHRWpkWEpzY3k5QVJXeGxiV1Z1ZENJc0ltOWtZWFJoTG1WMFlXY2lPaUpYTDF3aVpHRjBaWFJwYldVbk1qQXlNaTB4TUMwd01sUXdNU1V6UVRNMEpUTkJNemd1Tmpnd01USTBPVm9uWENJaUxDSlFZWEowYVhScGIyNUxaWGtpT2lJeElpd2lVbTkzUzJWNUlqb2lZVEkwTXpSaFpqTXRaVGs1WXkwME1UUXhMV0kzWlRndE56UTJOREExT1dSak5tSTFJaXdpVkdsdFpYTjBZVzF3SWpvaU1qQXlNaTB4TUMwd01sUXdNVG96TkRvek9DNDJPREF4TWpRNVdpSXNJbEJ5YjIxd2RGUmxlSFFpT2lKQklHMWhhV3h0WVc0aUxDSlRaV1ZrY3lJNklqUXhNRGM1TlNJc0lrUnBjM0JzWVhsT1lXMWxJam9pUkc5bklpd2lVMjkxY21ObElqb2lZMnhwWlc1MEluMD0iDQoJfSwNCgl7DQoJCSJNZXNzYWdlSWQiOiAiNmU3NTNhYjAtYThmNi00YWU2LWExYjctYjc1NmE2ODhkNTA5IiwNCgkJIkluc2VydGlvblRpbWUiOiAiU3VuLCAwNSBPY3QgMjAyMiAwMTozNDozOSBHTVQiLA0KCQkiRXhwaXJhdGlvblRpbWUiOiAiU3VuLCAwOSBPY3QgMjAyMiAwMTozNDozOSBHTVQiLA0KCQkiUG9wUmVjZWlwdCI6ICJBZ0FBQUFNQUFBQUFBQUFBSk5zU1BQL1YyQUU9IiwNCgkJIlRpbWVOZXh0VmlzaWJsZSI6ICJTdW4sIDAxIE9jdCAyMDIyIDAxOjM1OjIwIEdNVCIsDQoJCSJEZXF1ZXVlQ291bnQiOiAiMiIsDQoJCSJNZXNzYWdlVGV4dCI6ICJleUp2WkdGMFlTNXRaWFJoWkdGMFlTSTZJbWgwZEhCek9pOHZZWEowYVdacFkybGhiR0Z5ZEdsbVlXTjBjemxpTlRBdWRHRmliR1V1WTI5eVpTNTNhVzVrYjNkekxtNWxkQzhrYldWMFlXUmhkR0VqZFhKc2N5OUFSV3hsYldWdWRDSXNJbTlrWVhSaExtVjBZV2NpT2lKWEwxd2laR0YwWlhScGJXVW5NakF5TWkweE1DMHdNbFF3TVNVelFUTTBKVE5CTXpndU5qZ3dNVEkwT1ZvblhDSWlMQ0pRWVhKMGFYUnBiMjVMWlhraU9pSXhJaXdpVW05M1MyVjVJam9pWVRJME16Umhaak10WlRrNVl5MDBNVFF4TFdJM1pUZ3ROelEyTkRBMU9XUmpObUkxSWl3aVZHbHRaWE4wWVcxd0lqb2lNakF5TWkweE1DMHdNbFF3TVRvek5Eb3pPQzQyT0RBeE1qUTVXaUlzSWxCeWIyMXdkRlJsZUhRaU9pSkJJRzFoYVd4dFlXNGlMQ0pUWldWa2N5STZJalF4TURjNU5TSXNJa1JwYzNCc1lYbE9ZVzFsSWpvaVJHOW5JaXdpVTI5MWNtTmxJam9pWTJ4cFpXNTBJbjA9Ig0KCX0NCl0";
        var data2 = JSON.parse(atob(data + appendMe));

        var qMessages = data2.QueueMessagesList?.QueueMessage;
        //iterate through queue messages
        for (var i = 0; i < qMessages.length; i++) {
            var element = qMessages[i];
            //base64 decode the message
            var decoded = atob(element.MessageText);
            //parse the json
            var json = JSON.parse(decoded);

            //only add to state if the prompt value is not already in state
            if (state.filter(x => x.PromptText == json.PromptText).length == 0) {
                if (json.Source == "client") {         
                    state.push(element);
                }
            }

        }
        console.log(`state: ${JSON.stringify(state)}`);
    
    }
    
    function onlyAddUnique() {
        var data = "ew0KCSI/eG1sIjogew0KCQkiQHZlcnNpb24iOiAiMS4wIiwNCgkJIkBlbmNvZGluZyI6ICJ1dGYtOCINCgl9LA0KCSJRdWV1ZU1lc3NhZ2VzTGlzdCI6IHsNCgkJIlF1ZXVlTWVzc2FnZSI6IFsNCgkJCXsNCgkJCQkiTWVzc2FnZUlkIjogIjI5MWY3NTI1LWM5NTUtNGIwNC1iZjU0LTk0NzA4ZDFiZWU0ZiIsDQoJCQkJIkluc2VydGlvblRpbWUiOiAiU3VuLCAwMiBPY3QgMjAyMiAwMTozNToxMiBHTVQiLA0KCQkJCSJFeHBpcmF0aW9uVGltZSI6ICJTdW4sIDA5IE9jdCAyMDIyIDAxOjM1OjEyIEdNVCIsDQoJCQkJIlBvcFJlY2VpcHQiOiAiQWdBQUFBTUFBQUFBQUFBQUpOc1NQUC9WMkFFPSIsDQoJCQkJIlRpbWVOZXh0VmlzaWJsZSI6ICJTdW4sIDAzIE9jdCAyMDIyIDAxOjM1OjIwIEdNVCIsDQoJCQkJIkRlcXVldWVDb3VudCI6ICIyIiwNCgkJCQkiTWVzc2FnZVRleHQiOiAiZXlKdlpHRjBZUzV0WlhSaFpHRjBZU0k2SW1oMGRIQnpPaTh2WVhKMGFXWnBZMmxoYkdGeWRHbG1ZV04wY3psaU5UQXVkR0ZpYkdVdVkyOXlaUzUzYVc1a2IzZHpMbTVsZEM4a2JXVjBZV1JoZEdFamRYSnNjeTlBUld4bGJXVnVkQ0lzSW05a1lYUmhMbVYwWVdjaU9pSlhMMXdpWkdGMFpYUnBiV1VuTWpBeU1pMHhNQzB3TWxRd01TVXpRVE0wSlROQk5Ea3VOemN3TWpZeE0xb25YQ0lpTENKUVlYSjBhWFJwYjI1TFpYa2lPaUl4SWl3aVVtOTNTMlY1SWpvaVpUVTVPV00yTVRndFlXVTFNaTAwWkRRekxXSTJOV0V0TXpjMllqSmhZVFpoWldVeklpd2lWR2x0WlhOMFlXMXdJam9pTWpBeU1pMHhNQzB3TWxRd01Ub3pORG8wT1M0M056QXlOakV6V2lJc0lsQnliMjF3ZEZSbGVIUWlPaUpCSUdKcFp5QndkV1JrYkdVZ2IyWWdiV2xzYXlJc0lsTmxaV1J6SWpvaU16azNOekF3SWl3aVJHbHpjR3hoZVU1aGJXVWlPaUpFYjJkbmJ5SXNJbE52ZFhKalpTSTZJbU5zYVdWdWRDSjkiDQoJCQl9LA0KCQkJew0KCQkJCSJNZXNzYWdlSWQiOiAiNjFmOWU3NWUtZGEzZS00OGI2LTlmYzMtZDIxMjNjN2EyMmY2IiwNCgkJCQkiSW5zZXJ0aW9uVGltZSI6ICJTdW4sIDAyIE9jdCAyMDIyIDAxOjM0OjUwIEdNVCIsDQoJCQkJIkV4cGlyYXRpb25UaW1lIjogIlN1biwgMDkgT2N0IDIwMjIgMDE6MzQ6NTAgR01UIiwNCgkJCQkiUG9wUmVjZWlwdCI6ICJBZ0FBQUFNQUFBQUFBQUFBSk5zU1BQL1YyQUU9IiwNCgkJCQkiVGltZU5leHRWaXNpYmxlIjogIlN1biwgMDIgT2N0IDIwMjIgMDE6MzU6MjAgR01UIiwNCgkJCQkiRGVxdWV1ZUNvdW50IjogIjIiLA0KCQkJCSJNZXNzYWdlVGV4dCI6ICJleUp2WkdGMFlTNXRaWFJoWkdGMFlTSTZJbWgwZEhCek9pOHZZWEowYVdacFkybGhiR0Z5ZEdsbVlXTjBjemxpTlRBdWRHRmliR1V1WTI5eVpTNTNhVzVrYjNkekxtNWxkQzhrYldWMFlXUmhkR0VqZFhKc2N5OUFSV3hsYldWdWRDSXNJbTlrWVhSaExtVjBZV2NpT2lKWEwxd2laR0YwWlhScGJXVW5NakF5TWkweE1DMHdNbFF3TVNVelFUTTBKVE5CTkRrdU56Y3dNall4TTFvblhDSWlMQ0pRWVhKMGFYUnBiMjVMWlhraU9pSXhJaXdpVW05M1MyVjVJam9pWlRVNU9XTTJNVGd0WVdVMU1pMDBaRFF6TFdJMk5XRXRNemMyWWpKaFlUWmhaV1V6SWl3aVZHbHRaWE4wWVcxd0lqb2lNakF5TWkweE1DMHdNbFF3TVRvek5EbzBPUzQzTnpBeU5qRXpXaUlzSWxCeWIyMXdkRlJsZUhRaU9pSkJJR0pwWnlCd2RXUmtiR1VnYjJZZ2JXbHNheUlzSWxObFpXUnpJam9pTXprM056QXdJaXdpUkdsemNHeGhlVTVoYldVaU9pSkViMmRuYnlJc0lsTnZkWEpqWlNJNkltTnNhV1Z1ZENKOSINCgkJCX0sDQoJCQl7DQoJCQkJIk1lc3NhZ2VJZCI6ICI2ZTc1M2FiMC1hOGY2LTRhZTYtYTFiNy1iNzU2YTY4OGQ1MDkiLA0KCQkJCSJJbnNlcnRpb25UaW1lIjogIlN1biwgMDIgT2N0IDIwMjIgMDE6MzQ6MzkgR01UIiwNCgkJCQkiRXhwaXJhdGlvblRpbWUiOiAiU3VuLCAwOSBPY3QgMjAyMiAwMTozNDozOSBHTVQiLA0KCQkJCSJQb3BSZWNlaXB0IjogIkFnQUFBQU1BQUFBQUFBQUFKTnNTUFAvVjJBRT0iLA0KCQkJCSJUaW1lTmV4dFZpc2libGUiOiAiU3VuLCAwMSBPY3QgMjAyMiAwMTozNToyMCBHTVQiLA0KCQkJCSJEZXF1ZXVlQ291bnQiOiAiMiIsDQoJCQkJIk1lc3NhZ2VUZXh0IjogImV5SnZaR0YwWVM1dFpYUmhaR0YwWVNJNkltaDBkSEJ6T2k4dllYSjBhV1pwWTJsaGJHRnlkR2xtWVdOMGN6bGlOVEF1ZEdGaWJHVXVZMjl5WlM1M2FXNWtiM2R6TG01bGRDOGtiV1YwWVdSaGRHRWpkWEpzY3k5QVJXeGxiV1Z1ZENJc0ltOWtZWFJoTG1WMFlXY2lPaUpYTDF3aVpHRjBaWFJwYldVbk1qQXlNaTB4TUMwd01sUXdNU1V6UVRNMEpUTkJNemd1Tmpnd01USTBPVm9uWENJaUxDSlFZWEowYVhScGIyNUxaWGtpT2lJeElpd2lVbTkzUzJWNUlqb2lZVEkwTXpSaFpqTXRaVGs1WXkwME1UUXhMV0kzWlRndE56UTJOREExT1dSak5tSTFJaXdpVkdsdFpYTjBZVzF3SWpvaU1qQXlNaTB4TUMwd01sUXdNVG96TkRvek9DNDJPREF4TWpRNVdpSXNJbEJ5YjIxd2RGUmxlSFFpT2lKQklHMWhhV3h0WVc0aUxDSlRaV1ZrY3lJNklqUXhNRGM1TlNJc0lrUnBjM0JzWVhsT1lXMWxJam9pUTJGMElpd2lVMjkxY21ObElqb2lZMnhwWlc1MEluMCINCgkJCX0NCgkJXQ0KCX0NCn0";
        var data2 = JSON.parse(atob(data));
        var state = [];

        var qMessages = data2.QueueMessagesList?.QueueMessage;
        //iterate through queue messages
        for (var i = 0; i < qMessages.length; i++) {
            var element = qMessages[i];
            //base64 decode the message
            var decoded = atob(element.MessageText);
            //parse the json
            var json = JSON.parse(decoded);

            console.log(`State: ${JSON.stringify(state)}`);

            //only add to state if the prompt value is not already in state
            if (state.filter(x => JSON.parse(atob(x.MessageText)).PromptText == json.PromptText).length == 0) {
                if (json.Source == "client") {
                    console.log(`Prompt:${json.PromptText} does not exist in state, adding to state:DequeueCount:${element.DequeueCount}`);
                    state.push(element);
                }
            }

        }
        console.log(`state- count (should be 2): ${state.length}`);
    }

</script>

<body>

    <button onclick="runTests();">Run Tests</button>

</body>

</html>